\documentclass[a4paper,12pt]{scrartcl}
\usepackage{reg2021}
\usepackage{quiver}
\usepackage{bbold}

\begin{document}
\noindent\textbf{Author}\hfill\textbf{Year} \linebreak
\vspace*{-.1cm} Matteo Durante\hfill 2022 \\

\noindent
\rule{\linewidth}{1pt}
\begin{center}
\Large
    \textbf{From Dependent Type Theory to Locally Cartesian Closed
    $(\infty,1)$-Categories} \\
\end{center}
\rule{\linewidth}{1pt}
\\

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\La}{\Lambda}
\newcommand{\pa}{c}
\newcommand{\ob}{\operatorname{Ob}}
\newcommand{\mor}{\operatorname{Mor}}
\newcommand{\sto}{\twoheadrightarrow}

\newcommand{\plim}{\varprojlim}
\newcommand{\sst}{\subseteq}
\newcommand{\eq}{\operatorname{eq}}

\newcommand{\f}{\varphi}

\newcommand{\sing}{\operatorname{Sing}}

\newcommand{\ihom}{\underline{\Hom}}

\section{This is [not] an outline}

We can also rewrite the paper by Kapulkin about LCCC arising from TT using the
language of localizations of quasi-categories. There they develop the relevant
theory showing that under some conditions the frame associated to a fibration
category is locally cartesian closed, but using Cisinski's results we can prove
the same theorem directly using a more mainstream theory.

What should be included in such an overview?

1- Cisinski's theory of localizations (of fibration $\infty$-categories)

2- an introduction to contextual categories: where do they come from? Why are
they useful? Check out Voevodsky's papers about C-systems

We explain what dependent type theory is (Martin-Lof's notes from 1984) and why
it's an interesting foundation of mathematics. We mention Homotopy Type Theory
as an effort to provide homotopical foundations which better model how we think
about identities, which explains why intensional identity types are more
interesting to us than extensional ones.

We move on to defining contextual categories (1211.2851, 1406.7413, 1507.02648)
and what
the Pi, Sigma and Id structures are (1406.7413, 1211.2851 Appendix B). To
understand what the link between such structures and syntactically presented
type theories we refer to 1507.02648, Sec.\ 1.1, while the statement of the
conjectured correspondence is in 1304.0680, Sec.\ 2.1.

Where does the link between dependent type theories and $\infty$-categories come
from? We see that $\infty$-categories intuitively model the behavior of type
theories and their type constructions, especially when considering Homotopy Type
Theory, however this relation is known only
partially (references in the intro of 1507.02648). The idea is that the type
theory we are interested in should be the internal language of some class of
$\infty$-categories and a precise statement would require us to provide
homotopical functors in both directions which induce an equivalence on the
associated $\infty$-categories. The idea is to construct the
functor from contextual categories as a localization functor, that is we need to
provide a homotopical structure on contextual categories, as they do in
1507.02648 (there should be an older reference) which then provides an
associated $\infty$-category. This is the object of the Initiality Conjecture,
stated in 1610.00037, in the hope that such a correspondence will extend to
Homotopy Type Theory and some notion of Elementary Higher Toposes, perhaps the
one specified in 1805.03805. At the moment we know that HoTT can be interpreted
in Higher Toposes with some structure. Current progress: 1709.09519, an upcoming
paper by Nguyen-Uemura (HoTTest talk).

Our aim is to show that when taking contextual categories with the structure we
specified earlier we obtain a locally cartesian closed $\infty$-category. To do
so we provide a fibrational structure on contextual categories (1304.0680,
1507.02648), which as we anticipate will imply that their simplicial
localizations are finitely complete. We also prove that the hypothesis of
\cite[Thm.\ 7.6.16]{Cis19} are satisfied, informing that this will be sufficient
to prove Kapulkin's main result from 1507.02648.

We then develop the theory of localizations of $\infty$-categories by Cisinski
and specifically develop the results concerning $\infty$-categories with
fibrations and weak equivalences. Localizations of such $\infty$-categories are
finitely complete. The objective is to show \cite[Thm.\ 7.6.16]{Cis19}. How in
depth should we go?

Why all of this is interesting: we are proving Kapulkin's result internalizing
all of the discussion within the language of $\infty$-category theory and
relying only on its simplicial model.

\section{Localizations of \texorpdfstring{$\infty$}{âˆž}-Categories}

To prove that localizing a categorical model of type theory we get a locally
cartesian closed $\infty$-category we need a theory of localizations. We shall
provide one in the general context of $\infty$-categories as developed by
Cisinski in \emph{Higher Categories and Homotopical Algebra} with the aim of
proving \cite[Thm.\ 7.6.16]{Cis19}, which will do the heavy lifting in showing
the desired result. Those familiar with the theory may skip the entire chapter
while keeping in mind yadda yadda \wfd{(LIST THE MAJOR RESULTS)}.

\begin{defn}
  Let $X$ be a simplicial set and $W\subset X$ a simplicial subset. Given an
  $\infty$-category $\cC$, we define $\Home_W(X,\cC)$ to be the full simplicial
  subset of $\Home(X,\cC)$ whose objects are the morphisms $f\colon
  X\rightarrow\cC$ sending the 1-simplices in $W$ to isomorphisms.
\end{defn}

\begin{rmk}
  The above definition induces a canonical pullback square
  \[\begin{tikzcd}
    {\Home_W(X,\cC)} & {\Home(X,\cC)} \\
    {\Home_W(W,\cC)} & {\Home(W,\cC)}
    \arrow[from=1-1, to=2-1]
    \arrow[from=2-1, to=2-2]
    \arrow[from=1-2, to=2-2]
    \arrow[from=1-1, to=1-2]
    \arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=2-2]
  \end{tikzcd}\]
  given by the inclusion $W\rightarrow X$.
\end{rmk}

\begin{defn}
  Given an $\infty$-category $\cC$ and $W\subset\cC$, a \emph{localization of
  $\cC$ by $W$} is a functor $\gamma\colon\cC\rightarrow L(\cC)$ such that:
  \begin{enumerate}
    \item $L(\cC)$ is an $\infty$-category;
    \item $\gamma$ sends the 1-simplices of $W$ to isomorphisms in $L(\cC)$;
    \item for any $\infty$-category $\cD$ there is an equivalence of
      $\infty$-categories
      \[\Home(L(\cC),\cD)\rightarrow\Home_W(\cC,\cD)\]
      given by precomposing with $\gamma$.
  \end{enumerate}
\end{defn}

\wfd{(CISINSKI DOES NOT ASK FOR $\cC$ TO BE AN $\infty$-CATEGORY. SHOULD WE
BE LESS GENERAL AS WE HAVE DONE?)}

\begin{prop}\label{exuniq}
  Given an $\infty$-category $\cC$ and a subsimplicial set $W$, the localization
  of $\cC$ by $W$ always exists and it is essentially unique.
\end{prop}
\begin{proof}
  We begin by proving that a localization exists in the case where $W=\cC$.

  In this context, $\Home_W(\cC,\cD)\cong\Home(\cC,\cD^{\cong})$ canonically,
  where $\cD^{\cong}$ is the maximal subgroupoid of $\cD$.
  Factoring $\cC\rightarrow\Delta^0$ in the Kan model structure, we find an
  anodyne map $\gamma\colon\cC\rightarrow L(\cC)$.

  Remember that for any anodyne map $A\rightarrow B$ we get a trivial fibration
  $\Home(B,\cD^{\cong})\rightarrow\Home(A,\cD^{\cong})$. Looking then at the
  commutative diagram
  \[\begin{tikzcd}
    {\Hom(L(\cC),\cD^{\cong})} & {\Hom_W(\cC,\cD^{\cong})} \\
    {\Home(L(\cC),\cD)} & {\Home_W(\cC,\cD)}
    \arrow["\gamma^*", "\sim"', two heads, from=1-1, to=1-2]
    \arrow[from=1-1, to=2-1]
    \arrow["{\gamma^*}"', from=2-1, to=2-2]
    \arrow["\cong", from=1-2, to=2-2]
    \arrow["\cong"', from=1-1, to=2-1]
  \end{tikzcd},\]
  by the 2-out-of-3 property we see that the lower $\gamma^*$ is an equivalence.
  
  We now move on to the general case. First of all, notice that as a particular
  case of the previous one we get that localizing $\Delta^1$ at its non-trivial
  morphism we obtain $\Delta^1\rightarrow J=L(\Delta^1)\sim\Delta^0$. Taking
  then $W\subset\cC$, we consider the commutative diagram
  \[\begin{tikzcd}
    {\coprod_{f\in W_1}\Delta^1} & \cC \\
    {\coprod_{f\in W_1}J} & {\cC'} \\
    && {L(\cC)}
    \arrow[from=1-1, to=1-2]
    \arrow[from=1-1, to=2-1]
    \arrow[from=2-1, to=2-2]
    \arrow[from=1-2, to=2-2]
    \arrow[from=1-1, to=2-1]
    \arrow["\sim"', hook, from=2-2, to=3-3]
    \arrow["\gamma", curve={height=-12pt}, from=1-2, to=3-3]
    \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=1-1]
  \end{tikzcd},\]
  where $\cC'\rightarrow L(\cC)$ is an inner anodyne map obtained by taking the
  fibrant replacement of $\cC'$ in the Joyal model structure. This can be done
  functorially via the small object argument.

  For any $\infty$-category $\cD$, we get a trivial fibration
  $\Home(L(\cC),\cD)\rightarrow\Home(\cC',\cD)$ and a pullback square
  \[\begin{tikzcd}
    {\Home(\cC',\cD)} & {\Home(\cC,\cD)} \\
    {\Pi_{f\in W_1}\Home(J,\cD)} & {\Pi_{f\in W_1}\Home(\Delta^1,\cD)}
    \arrow[from=1-2, to=2-2]
    \arrow[from=2-1, to=2-2]
    \arrow[from=1-1, to=2-1]
    \arrow[from=1-1, to=1-2]
  \end{tikzcd},\]
  which together with the pullback
  \[\begin{tikzcd}
    {\Home_W(\cC,\cD)} & {\Home(\cC,\cD)} \\
    {\Pi_{f\in W_1}\Home(\Delta^1,\cD^{\cong})} & {\Pi_{f\in W_1}\Home(\Delta^1,\cD)}
    \arrow[from=1-2, to=2-2]
    \arrow[from=2-1, to=2-2]
    \arrow[from=1-1, to=2-1]
    \arrow[from=1-1, to=1-2]
  \end{tikzcd}\]
  implies by pasting that
  \[\begin{tikzcd}
    {\Home(\cC',\cD)} & {\Home_W(\cC,\cD)} \\
    {\Pi_{f\in W_1}\Home(J,\cD)} & {\Pi_{f\in W_1}\Home(\Delta^1,\cD^{\cong})}
    \arrow[from=1-2, to=2-2]
    \arrow[from=1-1, to=1-2]
    \arrow[from=1-1, to=2-1]
    \arrow["\sim", two heads, from=2-1, to=2-2]
    \arrow[from=1-2, to=2-2]
  \end{tikzcd}\]
  is also a pullback and therefore the upper arrow is a trivial fibration.
  Composing it with the other one we get
  $\gamma^*\colon\Home(L(\cC),\cD)\rightarrow\Home_W(\cC,\cD)$, which is then a
  trivial fibration and therefore an equivalence of $\infty$-categories.

  7.1.4 Observe that, through this construction, one can always construct
  $L(\cC)$ so that $\gamma$ is a bijection on objects because $\cC'\rightarrow
  L(\cC)$ is an inner anodyne extension and therefore a retract of a countable
  composition of sums of pushouts of maps which are the identity on objects,
  that is the inner horn inclusions.

  We now move on to proving that the localization is essentially unique. For
  this, we notice that $\gamma$ establishes then an isomorphism between
  $\pi_0(k(\Home_W(\cC,-)))$ and $\pi_0(\Home(L(\cC),-))=ho(\sSet)(L(\cC),-)$
  with respect to the Joyal model structure, thus by Yoneda $(L(\cC),\gamma)$ is
  unique up to unique isomorphism in $ho(\sSet)$ and up to a contractible space
  of equivalences in $\sSet$.
\end{proof}

\begin{rmk}\label{715}
  7.1.5

  In this context, we may define $\overline{W}$, the saturation of $W$ in $\cC$,
  as the cartesian square

  such that $\overline{W}$ is precisely the maximal simplicial subset of $\cC$
  whose morphisms are the ones which become invertible in $L(\cC)$, that is
  $W\cong k(L(\cC))\times_{L(\cC)}\cC$ canonically.

  We have then inclusions $Sk_1(W)\subset W\subset\overline{W}$ and, for any
  $\infty$-category $\cD$, this induces equalities
  \[\Home_{Sk_1(W)}(\cC,\cD)=\Home_{W}(\cC,\cD)\Home_{\overline{W}}(\cC,\cD),\]
  implying that $(L(\cC),\gamma)$ is also the localization of $\cC$ by $Sk_1(W)$
  and the one by $\overline{W}$, however the inclusion $W\rightarrow\cC$ is a
  fibration in the Joyal model category as it is the pullback of one, implying
  that $\overline{W}$ is itself an $\infty$-category.

  We shall say that $W$ is saturated if $W=\overline{W}$.
\end{rmk}

\begin{rmk}
  7.1.6

  The functor $ho(\cC)\rightarrow ho(L(\cC))$ exibits $ho(L(\cC))$ as the
  1-categorical localization of $\cC$ at $\Arr(\tau(W))$, as can be seen by
  using the universal property.

  On the other hand, given a 1-category $\cC$ and localizing at a set of
  morphisms $W$, not necessarily the induced map $L(N(\cC))\rightarrow
  N(L(\cC))$ is an isomorphism. Indeed, $L(N(\cC))$ can have much better
  properties, as can be seen for example from yadda yadda \wfd{(PROPOSITION
  ABOUT FINITE COMPLETENESS)} and in fact localizing 1-categories after taking
  their nerves gives every $\infty$-category \wfd{(MORE
  PRECISE STATEMENT)}.
\end{rmk}

\begin{prop}
  7.1.9

  Given a universe $\bfU$ and $W$ a simplicial subset of a $\bfU$-small
  $\infty$-category $\cC$, let $\gamma\colon\cC\rightarrow L(\cC)$ be the
  associated localization. Then the functor
  $\gamma^*\colon\Home(L(\cC)^{\op},\cS)\rightarrow\Home(\cC^{\op},\cS)$ is
  fully faithful and its essential image consists of all presheaves
  $F\colon\cC^{\op}\rightarrow\cS$ sending maps $u\colon x\rightarrow y$ in $W$
  to invertible maps $u^*\colon Fy\rightarrow Fx$ in $\cS$.
\end{prop}
\begin{proof}
  The map $\gamma$ gives us a morphism
  \[\gamma^*\colon\Home(L(\cC)^{\op},\cS)\simeq\Home_{W^{\op}}(\cC^{\op},\cS)\rightarrow\Home(\cC^{\op},\cS),\]
  which has a left adjoint $\gamma_!$ and a right adjoint $\gamma_*$. Now, or
  any presheaf $F\colon L(\cC)^{\op}\rightarrow\cS$, the unit map
  $F\rightarrow\gamma_*\gamma^*F$ is invertible and, by adjunction, the same
  goes for the counit map $\gamma_!\gamma^*F\rightarrow F$, which means that
  $u^*$ is fully faithful. On the other hand, given a presheaf
  $F\colon\cC^{\op}\rightarrow\cS$ sending 1-simplices in $W$ to invertible maps,
  the counit $\gamma^*\gamma_*F\rightarrow F$ and the unit
  $F\rightarrow\gamma^*\gamma_!F$ are both invertible since the restrictions of
  these adjunctions to $\Home_{W^{\op}}(\cC^{\op},\cS)$ form adjoint
  equivalences of $\infty$-categories as $\gamma^*$ is an equivalence.
\end{proof}

\begin{prop}\label{final}
  7.1.10

  Given an $\infty$-category $\cC$ and a simplicial subset $W$, the localization
  functor $\gamma\colon\cC\rightarrow L(\cC)$ is final and cofinal. In
  particular, if $e\colon\Delta^0\rightarrow\cC$ encodes a final or a cofinal
  object, so does $\gamma(e)$.
\end{prop}
\begin{proof}
  First of all, the functor $\gamma^{\op}$ is also a localization, so it
  suffices to prove that $\gamma$ is final. To do this, we look at the
  commutative diagram of $\infty$-categories
  \[\begin{tikzcd}
    \cC && {L(\cC)} \\
    & {\Delta^0}
    \arrow["\gamma", from=1-1, to=1-3]
    \arrow[from=1-1, to=2-2]
    \arrow[from=1-3, to=2-2]
  \end{tikzcd},\]
  which induces the commutative diagram
  \[\begin{tikzcd}
    & {\Home(\Delta^0,\cS)\cong\cS} \\
    {\Home(L(\cC),\cS)} && {\Home(\cC,\cS)}
    \arrow["\gamma^*"', from=2-1, to=2-3]
    \arrow[from=1-2, to=2-1]
    \arrow[from=1-2, to=2-3]
  \end{tikzcd}\]
  where the lower map is fully faithful. Also, $\gamma^*$ is the right adjoint
  of $\gamma_!$, hence taking left adjoints of the above maps gives us the
  diagram
  \[\begin{tikzcd}
    {\Home(\cC,\cS)} & {} & {\Home(L(\cC),\cS)} \\
    & \cS
    \arrow["\colim"', from=1-1, to=2-2]
    \arrow["\colim", from=1-3, to=2-2]
    \arrow["{\gamma_!}", from=1-1, to=1-3]
  \end{tikzcd},\]
  which commutes up to natural isomorphism.
  
  The unit $\id\rightarrow\gamma^*\gamma_!$ of the adjunction
  $\gamma_!\dashv\gamma^*$ is a natural isomorphism by full faithfulness of
  $\gamma^*$ and therefore we have the chain of isomorphisms
  \[\colim_\cD F\cong\colim_\cD(\gamma_!\gamma^*F)\cong\colim_\cC (\gamma^*F),\]
  for any functor $F\colon\cD\rightarrow\cS$, which proves our claim.
\end{proof}

\begin{prop}
  7.1.11
  Let's fix a universe $\bfU$, a $\bfU$-small $\infty$-category $\cC$ and a
  simplicial subset $W$. Consider then a functor $f\colon\cC\rightarrow\cD$,
  where $X$ is a small $\infty$-category. Then $f$ exhibits $\cD$ as the
  localization of $\cC$ by $W$ if and only if the following conditions hold:
  \begin{enumerate}
    \item the functor $f$ sends the 1-simplices of $W$ to invertible maps of
      $\cD$;
    \item the functor $f$ is essentially surjective;
    \item the functor $f^*$ induces an equivalence of $\infty$-categories
      \[f^*\colon\Home(\cD^{\op},\cS)\rightarrow\Home_{W^{\op}}(\cC^{\op},\cS).\]
  \end{enumerate}
\end{prop}
\begin{proof}
  One implication is trivial (for (2) look at the construction in \ref{exuniq}).
  For the converse, let's pick a localization $\gamma\colon\cC\rightarrow
  L(\cC)$ and, through condition (1), we get a factorization $g\colon
  L(\cC)\rightarrow\cD$ such that $g\cdot\gamma\cong f$, giving us a triangle
  \[\begin{tikzcd}
    {\Home(\cD^{\op},\cE)} && {\Home(L(\cC)^{\op},\cE)} \\
                           & {\Home_{W^{\op}}(\cC^{\op},\cE)}
    \arrow["{g^*}", from=1-1, to=1-3]
    \arrow["{f^*}"', from=1-1, to=2-2]
    \arrow["{\gamma^*}", from=1-3, to=2-2]
  \end{tikzcd}\]
  commuting up to $J$-homotopy for any $\infty$-category $\cE$. Picking
  $\cE=\cS$, $\gamma^*$ and $f^*$ are equivalences
  of $\infty$-categories, the latter by (3). It follows by 2-out-of-3 that $g^*$
  is one too, and therefore the same applies to its left adjoint $g_!$, which is
  then fully faithful. This is equivalent to $g$ being fully faithful \wfd{(FUN
  THEOREM, MAYBE STATE IT AT LEAST 6.1.5)} and, since
  $f$ is essentially surjective by (2), the same goes for $g$. It follows that
  $g$ is an equivalence of $\infty$-categories.
\end{proof}

\begin{prop}
  7.1.14

  Let $f\colon\cC\rightarrow\cD$ be a functors between $\infty$-categories with
  a right adjoint $g\colon\cD\rightarrow\cC$ and suppose that we are given
  simplicial subsets $V\subset\cC$, $W\subset\cD$ such that $f(V)\subset W$,
  $g(W)\subset V$. Then we can lift them to an adjunction
  $\adjunction{\overline{f}}{L(\cC)}{L(\cD)}{\overline{g}}$ such that the
  diagrams
  \[\begin{tikzcd}
    \cC & \cD \\
    {L(\cC)} & {L(\cD)}
    \arrow["{\gamma_\cD}", from=1-2, to=2-2]
    \arrow["{\gamma_\cC}"', from=1-1, to=2-1]
    \arrow["{\overline{f}}"', from=2-1, to=2-2]
    \arrow["f", from=1-1, to=1-2]
  \end{tikzcd},
  \quad
  \begin{tikzcd}
    \cD & \cC \\
    {L(\cD)} & {L(\cC)}
    \arrow["{\gamma_\cC}", from=1-2, to=2-2]
    \arrow["{\gamma_\cD}"', from=1-1, to=2-1]
    \arrow["{\overline{g}}"', from=2-1, to=2-2]
    \arrow["g", from=1-1, to=1-2]
  \end{tikzcd}
  \]
\end{prop}
\begin{proof}
  Let's write $\Home_V^W(\cC,\cD)$ for the full subcategory of $\Home(\cC,\cD)$
  whose objects are functors $\phi$ such that $\phi(V)\subset W$. The
  equivalence
  $\gamma^*_\cC\colon\Hom(L(\cC),L(\cD))\rightarrow\Home_V(\cC,L(\cD))$ allows
  us to construct a functor
  $\Home^W_V(\cC,\cD)\rightarrow\Home_V(\cC,L(\cD))\rightarrow\Home(L(\cC,\cD))$
  which associates to any $\phi$ as above a functor $\overline{\phi}$ making the
  square
  \[\begin{tikzcd}
    \cD & \cC \\
    {L(\cD)} & {L(\cC)}
    \arrow["{\gamma_\cC}", from=1-2, to=2-2]
    \arrow["{\gamma_\cD}"', from=1-1, to=2-1]
    \arrow["{\overline{\phi}}"', from=2-1, to=2-2]
    \arrow["\phi", from=1-1, to=1-2]
  \end{tikzcd}\]
  commute up to $J$-homotopy.

  The proof works by observing that our map also lifts natural transformations
  functorially, which allows us to show the triangle identities for the lifted
  unit and counit.
\end{proof}

\begin{prop}
  7.1.18

  Let $u\colon\cC\rightarrow\cD$ be a functor between $\infty$-categories with a
  fully faithful right adjoint $v$ and consider $W=k(\cD)\times_\cD\cC$, the
  subcategory of maps of $\cC$ which become invertible in $\cD$. Then $u$
  exhibits $\cD$ as the localization of $\cC$ by $W$.
\end{prop}
\begin{proof}
  Given a localization $\gamma\colon\cC\rightarrow L(\cC)$ by $W$, we get a
  functor $\gamma\cdot v\colon\cD\rightarrow L(\cC)$ which, paired with the
  $\overline{u}$ obtained from the construction in the previous proof, lifts the
  adjunction $u\dashv v$ to the localizations (where $L(\cD)\cong\cD$ as we
  localize at the identities). Lifting maintains the counit invertible, which
  allows us to conclude that $\gamma\cdot v$ is fully faithful.

  Essential surjectivity
  follows from the fact that, for any object $c$ in $\cC$, the unit $\eta_c$ is
  such that $\epsilon_{u(c)}\cdot u(\eta_c)=\id_{u(c)}$ and, since $\epsilon$ is
  invertible, so is $u(\eta_c)$, thus $\eta_c$ becomes invertible in $L(\cC)$
  and shows that $(\gamma_{\cC}\cdot v)(u(c))=\gamma_{\cC}(vu(c))\cong c$.
  Notice that here we used that $L(\cC)_0=\cC_0$, which is permissible up to
  equivalence as previously noted.

  \wfd{(PLEASE CHECK PROOF)}
\end{proof}

%\begin{cor}
%  7.2.5
%\end{cor}
%\begin{proof}
%  7.1.5
%\end{proof}

%\begin{cor}
%  7.2.8
%\end{cor}
%\begin{proof}
%  7.1.5, 7.1.18, 7.2.5
%\end{proof}

%\begin{cor}
%  7.2.10
%\end{cor}

%\begin{cor}
%  7.2.15
%\end{cor}

%\begin{cor}
%  7.2.16
%\end{cor}

%\begin{cor}
%  7.2.18
%\end{cor}
%\begin{proof}
%  7.2.16
%\end{proof}

%\begin{cor}
%  7.2.25
%\end{cor}
%\begin{proof}
%  7.2.8, 7.2.10, 7.2.15
%\end{proof}

%\begin{cor}
%  7.3.2
%\end{cor}

%\begin{cor}
%  7.3.4
%\end{cor}

%\begin{cor}
%  7.3.5
%\end{cor}
%\begin{proof}
%  7.1.10, 7.3.2, 7.3.4
%\end{proof}

%\begin{cor}
%  7.3.8
%\end{cor}
%\begin{proof}
%  7.1.10, 7.1.12
%\end{proof}

%\begin{cor}
%  7.3.9
%\end{cor}
%\begin{proof}
%  7.3.8
%\end{proof}

%\begin{cor}
%  7.3.10
%\end{cor}
%\begin{proof}
%  7.3.9
%\end{proof}

%\begin{prop}
%  7.3.11
%\end{prop}

%\begin{cor}
%  7.3.15
%\end{cor}
%\begin{proof}
%  7.1.12, 7.3.9, 7.3.10
%\end{proof}

%\begin{cor}
%  7.3.16
%\end{cor}
%\begin{proof}
%  7.3.5, 7.3.15
%\end{proof}

%\begin{cor}
%  7.3.26
%\end{cor}

%\begin{cor}
%  7.3.27
%\end{cor}
%\begin{proof}
%  7.3.16, 7.3.26
%\end{proof}

%\begin{cor}
%  7.3.28
%\end{cor}

%\begin{cor}
%  7.3.29
%\end{cor}
%\begin{proof}
%  7.3.27, 7.3.28
%\end{proof}

%\begin{prop}
%  7.4.2
%\end{prop}

%\begin{prop}
%  7.4.11
%\end{prop}
%\begin{proof}
%  7.3.11, 7.4.2
%\end{proof}

\begin{defn}
  An \emph{$\infty$-category with weak equivalences and fibrations} is a triple
  $(\cC,W,Fib)$ where $\cC$ is an $\infty$-category with a final object,
  $W\subset\cC$ is a subcategory with the 2-out-of-3 property and
  $Fib\subset\cC$ a subsimplicial set such that:
  \begin{enumerate}
    \item for any pullback square of $\cC$
      \[\begin{tikzcd}
        {x'} & x \\
        {y'} & y
        \arrow["p", from=1-2, to=2-2]
        \arrow["{p'}"', from=1-1, to=2-1]
        \arrow["v"', from=2-1, to=2-2]
        \arrow["u", from=1-1, to=1-2]
      \end{tikzcd}\]
      in which $y$ is fibrant and $p$ lies in $Fib$ (and $W$), the same goes
      for $p'$;
    \item for any map $f\colon x\rightarrow y$ with fibrant codomain can be
      factored as a map in $W$ followed by one in $Fib$.
  \end{enumerate}
  By \emph{fibrant object} we mean an object whose map to the terminal one is in
  $Fib$.

  We shall call \emph{weak equivalences} the maps in $W$ and \emph{fibrations}
  the ones in $Fib$. Maps which are both shall be referred to as \emph{trivial
  fibrations}.
\end{defn}

%\begin{prop}
%  7.4.13
%\end{prop}

%\begin{cor}
%  7.4.14
%\end{cor}
%\begin{proof}
%  7.4.13
%\end{proof}

%\begin{prop}
%  7.4.16
%\end{prop}
%\begin{proof}
%  7.4.13
%\end{proof}

%\begin{prop}
%  7.4.19
%\end{prop}
%\begin{proof}
%  7.4.11
%\end{proof}

\begin{prop}
  7.5.5
\end{prop}

\begin{prop}\label{756}
  7.5.6

  Given an $\infty$-category with weak equivalences and fibrations $\cC$, the
  localization $L(\cC_f)$ has finite limits and the localization functor
  $\cC_f\rightarrow L(\cC_f)$ is left exact. Moreover, for any $\infty$-category
  $\cD$ with finite limits and any left exact functor
  $f\colon\cC_f\rightarrow\cD$, the induced functor $\overline{F}\colon
  L(\cC_f)\rightarrow\cD$ is left exact.
\end{prop}
\begin{proof}
  Maybe do not prove it? It relies on a bunch of results from ch. 7.2, 7.3, 7.4
  which we do not really want to prove.

  7.1.10, 7.2.18, 7.2.25, 7.3.27, 7.4.13, 7.4.16
\end{proof}

\begin{defn}
  An $\infty$-category of fibrant objects is an $\infty$-category with weak
  equivalences and fibrations $\cC$ in which all objects are fibrant.
\end{defn}

\begin{exmp}
  For any $\infty$-category with weak equivalences and fibrations $\cC$, its
  full subcategory given by fibrant objects is an $\infty$-category of fibrant
  objects. We shall denote it by $\cC_f$.
\end{exmp}

\begin{prop}\label{7516}
  7.5.16

  Let $x$ be a fibrant object in an $\infty$-category with weak equivalences and
  fibrations $\cC$. The induced functor
  $\cC_f/\gamma_f(x)\rightarrow\cC/\gamma(x)$ is final.
\end{prop}
\begin{proof}
  We have that $\cC_f/\gamma_f(x)=L(\cC_f)/\gamma_f(x)\times_{L(\cC_f)}\cC_f$
  and $\cC/\gamma(x)=L(\cC)/\gamma(x)\times_{L(\cC)}\cC$ and the functor we are
  considering is induced by $\overline{\iota}\colon L(\cC_f)\rightarrow L(\cC)$.
  
  To prove that it is final, it is sufficient to show that for any object
  $(c,u)$ of $L(\cC)/\gamma(x)$ the coslice $(c,u)\\(\cC_f/\gamma_f(x))$ is
  weakly contractible and, to do this, by \cite[Lem.\ 4.3.15]{Cis19} we can show
  that any functor $F\colon E\rightarrow (c,u)\\(\cC_f/\gamma_f(x))$, where $E$
  is the nerve of a finite partially ordered set, is $\Delta^1$-homotopic to a
  constant functor. This can be done through the theory of Reedy fibrant
  diagrams developed in \cite[Ch.\ 7.4]{Cis19}.
\end{proof}

\begin{prop}\label{7517}
  7.5.17

  Let $\bfU$ be a universe and $\cC$ a $\bfU$-small $\infty$-category with weak
  equivalences and fibrations. For any $\infty$-category $\cD$ with $\bfU$-small
  colimits and any functor $F\colon\cC\rightarrow\cD$, we have an isomorphism
  \[(\gamma_f)_!\iota^*(F)\cong\overline{\iota}^*\gamma_!(F)\]
  induced by the square
  \[\begin{tikzcd}
    {\cC_f} & \cC \\
    {L(\cC_f)} & {L(\cC)}
    \arrow["\gamma", from=1-2, to=2-2]
    \arrow["{\gamma_f}"', from=1-1, to=2-1]
    \arrow["\iota", from=1-1, to=1-2]
    \arrow["{\overline{\iota}}"', from=2-1, to=2-2]
  \end{tikzcd},\]
  which commutes up to $J$-homotopy.
\end{prop}
\begin{proof}
  We only need to prove that the evaluation of the canonical map
  $(\gamma_f)_!\iota^*(F)\cong\overline{\iota}^*\gamma_!(F)$ at any object $x$
  of $\cC_f$ is invertible. This evaluation is equivalent by \cite[Prop.\
  6.4.9]{Cis19} to the map
  \[\colim_{\cC_f/\gamma_f(x)}i^*(F)/\gamma_f(x)\rightarrow\colim_{\cC/\gamma(x)}F/\gamma(x),\]
  where $F/\gamma(x)$ is define by composing $F$ with the canonical projection
  $\cC/\gamma(x)\rightarrow\cC$ and similarly for $i^*(F)/\gamma_f(x)$. Using
  \ref{7516} and the commutativity of the square above, we get that the desired
  map is indeed invertible for all $x$.
\end{proof}

\begin{prop}\label{7518}
  7.5.18

  Let $\cC$ be an $\infty$-category with weak equivalences and fibrations. The
  canonical functor $\overline{\iota}\colon L(\cC_f)\rightarrow L(\cC)$ is an
  equivalence of $\infty$-categories, hence the $\infty$-category $L(\cC)$ has
  finite limits and the localization functor $\gamma\colon\cC\rightarrow L(\cC)$
  is left exact.
\end{prop}
\begin{proof}
  7.5.6, 7.5.17

  We already know that $\overline{\iota}$ is essentially surjective as every
  object in $\cC$ is weakly equivalent to one in $\cC_f$ and the localization
  functors are essentially surjective themselves, thus it is enough to prove
  that it is fully faithful. To do this, we may fix a universe $\bfU$ such that
  $\cC$ is $\bfU$-small and prove that the functor
  \[\overline{\iota}_!\colon\Home(L(\cC_f),\cS)\rightarrow\Home(L(\cC),\cS)\]
  is fully faithful by \cite[Prop.\ 6.1.15]{Cis19}, which is equivalent to
  proving that the unit map $1\rightarrow\overline{\iota}^*\overline{\iota}_!$
  of the adjunction $\overline{\iota}^*\dashv\overline{\iota}_!$ is invertible.

  We know that $\overline{\iota}_*$ and $\overline{\iota}^*$ both have right
  adjoints, thus they preserve colimits. Also, every $\cS$-valued functor
  indexed by a $\bfU$-small $\infty$-category can be obtained as a colimit of
  representable ones, hence it is enough to check that the condition holds for
  any representable functor $F$. Also, $\gamma_f$ is essentially surjective,
  which means that it is sufficient to check that map
  $(\gamma_f)_!\rightarrow\overline{\iota}^*\overline{\iota}_!(\gamma_f)_!$
  which we get by precomposing the unit with $(\gamma_f)_!$ is invertible.

  We have then the chain of isomorphisms
  \begin{align*}
    (\gamma_f)_! &\cong(\gamma_f)_!\overline{\iota}^*\overline{\iota}_! \\
                 &\cong\overline{\iota}^*\gamma_f\iota_! \\
                 &\cong\overline{\iota}^*\overline{\iota}_!(\gamma_f)_!,
  \end{align*}
  where the first isomorphism comes from the full faithfulness of $\iota$, the
  second one from \ref{7517} and the last one the fact that
  $\overline{\iota}\cdot\gamma_f\cong\gamma\cdot\iota$, as noted in \ref{7517}.

  The second claim follows directly from the first one and \ref{756}.
\end{proof}

\begin{cor}\label{7519}
  7.5.19

  Let $\cC$ be an $\infty$-category with weak equivalences and fibrations. For a
  morphism between fibrant objects $p\colon x\rightarrow y$, the following
  conditions are equivalent:
  \begin{enumerate}
    \item the morphism $p$ has a section in $ho(L(\cC))$;
    \item there exists a morphism $p'\colon x'\rightarrow x$ s.t.\ the
      composition of $p'$ and $p$ is a weak equivalence;
    \item there exists a fibration $p'\colon x'\rightarrow x$ s.t.\ the
      composition of $p'$ and $p$ is a weak equivalence.
  \end{enumerate}
\end{cor}
\begin{proof}
  7.5.18

  We see that (iii) trivially implies (ii), therefore we shall focus on the
  other implication. Given then such a morphism $p'$, we factor it as $qi=p'$, a
  weak equivalence followed by a fibration. Since $p\cdot p'=p\cdot(q\cdot
  i)=(p\cdot q)\cdot i$, by 2-out-of-3 $p\cdot q$ is a weak equivalence, giving
  us what we wanted.

  Should we prove (i)? Uses right calculus of fractions, but it's rather simple.
\end{proof}

\begin{construction}\label{7522}
  7.5.22
  
  Given an $\infty$-category $\cC$ with weak equivalences and fibrations, we can
  get another one $\overline{\cC}$ with the same underlying $\infty$-category
  and class of fibrations, but where the weak equivalences are given by the
  saturation $\overline{W}$ as described in \ref{715}. We have that $L(\cC)\cong
  L(\overline{\cC})$, hence in general we can substitute $\cC$ by
  $\overline{\cC}$ with no issues. Also, the substitution commutes with the
  formation of slices over fibrant objects, that is, for any fibrant object $x$
  of $\cC$, a map in $\cC/x$ induces an invertible map in $L(\cC/x)$ if and only
  if its image becomes invertible in $L(\cC)$, which can be seen as a
  consequence of \ref{7519}.
\end{construction}

\begin{rmk}
  Let $\cC$ be an $\infty$-category with weak equivalences $W$ and
  $F\colon\cC\rightarrow\cD$ be a functor. The precomposition functor
  $\gamma^*\colon\Home(L(\cC),\cD)\rightarrow\Home(\cC,\cD)$ does not have a
  left adjoint in general, but we may ask whether $\Hom(F,\gamma^*(-))$ is
  representable in $\Home(L(\cC),\cD)$. If it is, a representative is denoted by
  $\bfR F\colon L(\cC)\rightarrow\cD$ and is called the \emph{right derived
  functor of $F$}. Beware that to be precise one would have to specify the
  natural transformation $F\rightarrow\bfR F\cdot\gamma$ exhibiting it as such.
  Dually, a representative of $\Hom(\gamma^*(-),F)$ is the \emph{left derived
  functor of $F$}.
\end{rmk}

\begin{prop}\label{7524}
  7.5.24

  If $F\colon\cC\rightarrow\cD$ sends weak equivalences to isomorphisms, then
  the functor $\overline{F}\colon L(\cC)\rightarrow\cD$, associated to $F$ by
  the universal property of $L(\cC)$, is the right derived functor of $F$.
\end{prop}
\begin{proof}
  Let's fix a universe $\bfU$ such that $\cC$ and $\cD$ are $\bfU$-small and let
  $G\colon L(\cC)\rightarrow\cD$ be any functor. Then the invertible map
  $\overline{F}\cdot\gamma\cong F$ and the equivalence of $\infty$-categories
  $\Home(L(\cC),\cD)\simeq\Home_W(\cC,\cD)$ induce invertible maps
  $\Hom(\overline{F},G)\simeq\Hom(\overline{F}\cdot\gamma,G\cdot\gamma)\simeq\Hom(F,G\cdot\gamma)$
  in $\cS$, functorially in $G$.
\end{proof}

\begin{construction}\label{7525}
  \wfd{(NOT COMPLETE, ONE MAY SHOW THAT OUR CONSTRUCTION DOES GIVE THE RIGHT
  DERIVED FUNCTOR)}

  Let $\cC$ be an $\infty$-category with weak equivalences and fibrations. Given
  any functor $F\colon\cC\rightarrow\cD$ sending weak equivalences between
  fibrant objects to invertible maps then has a right derived functor $\bfR F$,
  which may be constructed as follows.

  First we choose a quasi-inverse $R\colon L(\cC)\rightarrow L(\cC_f)$ of the
  equivalence of $\infty$-categories specified in \ref{7518}, then we choose a
  functor $\overline{F}\colon L(\cC_f)\rightarrow\cD$ and a natural isomorphism
  $j\colon\overline{F}\cdot\gamma_f\rightarrow F\cdot\iota$. We set then $\bfR
  F=\overline{F}\cdot R$. Also, for any other functor
  $G\colon\cD\rightarrow\cE$, we have that $G\cdot\bfR F=\bfR(G\cdot F)$.
\end{construction}

\begin{defn}
  Given an $\infty$-category with weak equivalences and fibrations $\cC$ and an
  $\infty$-category with weak equivalences $\cD$, let's consider a functor
  $F\colon\cC\rightarrow\cD$ preserving weak equivalences between fibrant
  objects of $\cC$. We call the \emph{right derived functor of} $F$ the right
  derived functor of the composition
  \[\cC\xrightarrow{F}\cD\xrightarrow{\gamma_{\cD}}L(\cD),\]
  where $\gamma_\cD$ is the localization functor of of $\cD$ at its weak
  equivalences. This right derived functor of $F$ is denoted by $\bfR F$, that
  is $\bfR F=\bfR(\gamma_{\cD}\cdot F)\colon L(\cC)\rightarrow L(\cD)$, which
  makes sense since we can apply the construction \ref{7525}.
\end{defn}

There are some interesting remarks which may be included!!!!

\begin{prop}
  7.5.28

  For any left exact functor $F\colon\cC\rightarrow\cD$ between
  $\infty$-categories with weak equivalences and fibrations, the right derived
  functor $\bfR F\colon L(\cC)\rightarrow L(\cD)$ is left exact.
\end{prop}
\begin{proof}
  7.5.6

  We have a square
  \[\begin{tikzcd}
    {L(\cC_f)} & {L(\cD_f)} \\
    {L(\cC)} & {L(\cD)}
    \arrow["{\overline{F}}", from=1-1, to=1-2]
    \arrow[from=1-2, to=2-2]
    \arrow[from=1-1, to=2-1]
    \arrow["{\bfR F}"', from=2-1, to=2-2]
  \end{tikzcd}\]
  commuting up to $J$-homotopy, where the vertical maps are equivalences of
  $\infty$-categories and $\overline{F}$ is the functor obtained by restricting
  $F$ to the subcategories of fibrant objects $\cC_f$ and $\cD_f$. It therefore
  suffices to show that $\overline{F}$ is left exact, but this follows from
  \ref{756}.
\end{proof}

\begin{rmk}
  \wfd{(WHY DO WE NEED TO SPECIFY THIS?)}

  For the remainder of this chapter, given an $\infty$-category $\cC$,
  subcategories of weak equivalences $W\subset\cC$ are such that the inclusion
  $W\rightarrow\cC$ is an inner fibration. This means that a simplex
  $x\colon\Delta^n\rightarrow\cC$ lies in $W$ if and only if its edges
  $x|_{\Delta^{\{i,i+1\}}}\colon \{i,i+1\}\rightarrow\cC$ lie in $W$ for $0\leq
  i<n$.

  $W$ then contains all invertible maps of $\cC$ if and only if the
  aforementioned inclusion is an isofibration.
\end{rmk}

\begin{lem}
  7.6.2
\end{lem}
\begin{proof}
  7.2.10.4, 7.2.18, 7.4.13
\end{proof}

\begin{lem}
  7.6.4
\end{lem}
\begin{proof}
  7.2.10.4, 7.2.18, 7.4.13
\end{proof}

\begin{lem}
  7.6.5
\end{lem}
\begin{proof}
  4.2.9
\end{proof}

\begin{lem}
  7.6.7
\end{lem}
\begin{proof}
  4.3.15, 7.4.19, 7.5.5
\end{proof}

\begin{thm}
  7.6.10
\end{thm}
\begin{proof}
  7.3.29, 7.6.2, 7.6.5, 7.6.7
\end{proof}

\begin{cor}
  7.6.13
\end{cor}
\begin{proof}
  7.5.18, 7.5.22, 7.5.24, 7.5.28, 7.6.4, 7.6.10
\end{proof}

\begin{thm}
  7.6.16
\end{thm}
\begin{proof}
  6.1.6, 6.1.7, 6.1.8, 7.1.14, 7.4.14, 7.5.18, 7.6.13
\end{proof}

\section{Categorical Models of TT as Locally Cartesian Closed Fibration
Categories}

\begin{defn}
  A fibration category $\cP$ is \emph{locally cartesian closed} if, for any
  fibration $p\colon a\rightarrow b$, the pullback functor
  $p^*\colon\cP\downarrow b\rightarrow\cP\downarrow a$ admits a right adjoint
  $p_*$ which is an exact functor.
\end{defn}

How does Kapulkin prove that a categorical model of Type Theory is a locally
cartesian closed fibration category?

First of all, he refers to AKL15 to show that $\cP$ has a fibrational structure,
then he goes on to show the following results, whose proofs are extremely terse
and therefore should be expanded.

\wfd{(I DON'T UNDERSTAND WHAT $f^*b$ SHOULD BE IN 1211.2851, DEF. 1.2.4. WHAT
FOLLOWS IS MY IDEA.)}

\begin{defn}
  Given $p_A\colon\Gamma.A\rightarrow\Gamma$, a section
  $a\colon\Gamma\rightarrow\Gamma.A$ and $f\colon\Delta\rightarrow\Gamma$, we
  look at the commutative diagram
  \[\begin{tikzcd}
    \Delta \\
    & {\Delta.f^*A} & {\Gamma.A} \\
    & \Delta & \Gamma \\
    \arrow["{p_A}", from=2-3, to=3-3]
    \arrow["f"', from=3-2, to=3-3]
    \arrow["{p_{f^*A}}", from=2-2, to=3-2]
    \arrow["{q(f,A)}"', from=2-2, to=2-3]
    \arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=2-2, to=3-3]
    \arrow[curve={height=12pt}, Rightarrow, no head, from=1-1, to=3-2]
    \arrow["{a\cdot f}", curve={height=-12pt}, from=1-1, to=2-3]
    \arrow["{f^*a}"{description}, dotted, from=1-1, to=2-2]
  \end{tikzcd},\]
  which gives us $f^*a$ as the factorization through the pullback square of the
  pair $(\id_\Delta,a\cdot f)$.
\end{defn}

\begin{lem}
  For any dependent projection $p_\Delta\colon\Gamma.\Delta\rightarrow\Gamma$ in
  a categorical model of type theory $\cC$, the pullback functor
  $p_\Delta^*\colon\cC\downarrow\Gamma\rightarrow\cC\downarrow\Gamma.\Delta$
  admits a right adjoint.
\end{lem}
\begin{proof}
  Kapulkin 1507.02648, Lemma 5.5.
\end{proof}

We know that every fibration in $\cC$ is isomorphic to a composite of dependent
projections , so this tells us that every fibration induces an adjunction
between fibrational slices \wfd{(YOU SHOULD DEFINE THEM)}.

\begin{lem}
  Consider an iterated context extension $\Gamma.\Delta.\Theta.\Psi$ in a
  categorical model of type theory $\cC$. Then the contexts
  \[\Gamma.\Pi(\Delta,\Theta).\Pi(p^*_{\Pi(\Delta,\Theta)}\Delta.app^*_{\Delta,\Theta}.\Psi)
    \text{ and }
  \Gamma.\Pi(\Delta,\Theta.\Psi)\]
  are isomorphic (actually equal) in $\cC$.
\end{lem}
\begin{proof}
  Kapulchin 1507.02648, Lemma 5.5. It simply refers to the construction of the
  $\Pi$-structure on $\cC^{cxt}$.
\end{proof}

We are finally ready to prove the result leading to the final one we want.

\begin{prop}\label{lccfc}
  A categorical model of type theory $\cC$ is a locally cartesian closed
  fibration category.
\end{prop}
\begin{proof}
  Kapulkin 1507.02648, Proposition 5.4.
\end{proof}

\begin{thm}
  Given a categorical model of type theory $\cC$, the $\infty$-category $L(\cC)$
  is locally cartesian closed.
\end{thm}
\begin{proof}
  Since a fibration category is more generally a $\infty$-category with
  fibrations and weak equivalences, we can apply \cite[Prop.\ 7.6.16]{Cis19} as
  the hypothesis are satisfied by \ref{lccfc}.
\end{proof}

\section{Pushforward}

One may ask whether cocartesian fibrations in $\sSet$ model Pi types, which is a
piece needed to understand a novel model of dependent type theory provided by
$\sSet$. To answer this question, an explicit description of the right adjoint
$p_*$ of the pullback functor $p^*\colon\sSet/Y\rightarrow\sSet/X$ induced by a
morphism $p\colon X\rightarrow Y$ is needed.

Consider an object $f\colon T\rightarrow X$ in $\sSet/X$. What is $p_*(f)\colon
T'\rightarrow Y$? We know that a $n$-simplex $t'$ of $T'$ corresponds
bijectively to a map $t'\colon\Delta^n\rightarrow T'$, which in turn corresponds
bijectively to a commutative diagram
\[\begin{tikzcd}
	{\Delta^n} & {} & {T'} \\
	& Y
	\arrow["{t'}", from=1-1, to=1-3]
	\arrow["y"', from=1-1, to=2-2]
	\arrow["{p_*(f)}", from=1-3, to=2-2]
\end{tikzcd}\]
and, under the adjunction $p^*\dashv p_*$, we get bijectively another
commutative diagram
\[\begin{tikzcd}
	U & {} & T \\
	& X
	\arrow["t", from=1-1, to=1-3]
	\arrow["{p^*(y)}"', from=1-1, to=2-2]
	\arrow["f", from=1-3, to=2-2]
\end{tikzcd},\]
from which follows that
\[T'_n\cong\{(y,t)\ |\ y\in Y_n,\ t\in\sSet/X(p^*(y),f)\}\]
and the map $p_*(f)$ then sends $(y,t)\in T'_n$ to $y\in Y_n$.

The same method can be extended to give us the pushforward along a map of marked
simplicial sets $p\colon (X,E_X)\rightarrow (Y,E_Y)$ in $\mSet$. Specifically,
our previous construction can be adapted to give us the $n$-simplices by
starting from maps $(\Delta^n)_\flat\rightarrow p_*(T,E_T)=(T',E_{T'})$, telling
us again that
\[T'_n\cong\{(y,t)\ |\ y\in Y_n,\ t\in\mSet/X(p^*(y),f)\},\]
while to get the markings we notice that every marked edge in $p_*(T,E_T)$
corresponds to a unique map $(\Delta^1)_\natural\rightarrow p_*(T,E_T)$ and the
same procedure allows us to write
\[E_{T'}=\{(y,t)\ |\ y\in E_Y,\ t\in\mSet/X(p^*(y),f)\},\]
which fully specifies the needed data.

Now, under which conditions on $p$ does this specify a Quillen adjunction when
the slices of $\mSet$ are equipped with the contravariant model structure? If
it is a coCartesian fibration, it generally doesn't, but it does when it is a
Cartesian fibration. How can we specify an approximation $q$ of $p_*$ such that,
after localizing in the infinity-sense, we get an adjunction $p^*\dashv q$?

Idea: use the theory of bifibrations. From a coCartesian fibration $\phi\colon
X\rightarrow Y$ we can construct a bifibration $E\rightarrow X\times Y$ by
constructing the maps $p\colon E\rightarrow X$, $q\colon E\rightarrow Y$ by
first taking the pullback of $\phi$ along $ev_0\colon Y^{\Delta^1}\rightarrow Y$
and then composing the map $E\rightarrow Y^{\Delta^1}$ with $ev_1$.
\[\begin{tikzcd}
	E & X \\
	{Y^{\Delta^1}} & Y \\
	Y
	\arrow["\phi", from=1-2, to=2-2]
	\arrow["{ev_0}", from=2-1, to=2-2]
	\arrow["p", from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow["{ev_1}", from=2-1, to=3-1]
	\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=2-2]
	\arrow["q"', curve={height=20pt}, from=1-1, to=3-1]
\end{tikzcd}\]

We want to show that, for any (coCartesian?)\ morphism $f\colon A\rightarrow X$,
we have an isomorphism between $\phi_*(f)$ and $q_*p^*(f)$.

Canonically, we have
\[E_n=\{(x,\Delta^n\times\Delta^1\xrightarrow{g}Y)\ |\ x\in X_n,\
\phi(x)=g|_{\Delta^n\times\{0\}}\}\]
and, by pasting the pullback squares, we also get
\[(\dom(p^*f))_n=\{(a,\Delta^n\times\Delta^1\xrightarrow{g} Y)\ |\ a\in A_n,\
f(a)=g|_{\Delta^n\times\{0\}}\}\]
and therefore
\begin{align*}
  (\dom(q_*p^*(f)))_n &=\{(y,q^*(y)\xrightarrow{g} p^*(f))\ |\ y\in Y_n\} \\
                      &=\{(y,p_!q^*(y)\xrightarrow{g} f)\ |\ y\in Y_n\},
\end{align*}
which we want to relate to $\phi_*(f)$.

To do this, we want to understand the maps $p_!q^*(y)\xrightarrow{g} f$ and
somehow relate them to $\phi^*(y)\rightarrow f$. By definition,
\begin{align*}
  \dom(p_!q^*(y))_k&=\dom(q^*(y))_k \\
                   &=\{(x,\Delta^k\times\Delta^1\xrightarrow{h}Y,t)\ |\ x\in
                     X_k,\ \phi(x)=h|_{\Delta^k\times\{0\}},\ t\in(\Delta^n)_k,\
                   y(t)=h|_{\Delta^k\times\{1\}}\},
\end{align*}
with $q^*(y)(x,h,t)=(x,h)$, thus $p_!q^*(y)(x,h,t)=x$.

On the other hand, we have
\[\dom(\phi^*(y))_k=\{(x,t)\ |\ x\in X_k,\ t\in(\Delta^n)_k,\ \phi(x)=y(t)\}\]
and $\phi^*(y)(t,x)=x$.

If we can create a bijection between morphisms of the form $p_!q^*(y)\rightarrow
f$ and $\phi^*(y)\rightarrow f$ we are done. Unfortunately, I do not see how we
can do this: any morphism $p_!q^*(y)\rightarrow f$ induces a
morphism $\phi^*(y)\rightarrow f$ by precomposing with the inclusion
$\phi^*(y)\rightarrow p_!q^*(y)$, $(x,t)\mapsto(x,h_{\phi(x)},t)$, where
$h_{\phi(x)}$ is obtained by precomposing $\phi(x)\colon\Delta^k\rightarrow Y$
with $p_{\Delta^k}\colon\Delta^k\times\Delta^1\rightarrow\Delta^k$, but this
association is only injective, not surjective, and I have no good idea about how
to construct others.

To construct the bijection I may start from a morphism $p_!q^*(y)->f$ and
construct another one with $\phi^*(y)$ as domain by lifting morphisms
$\Delta^k\times\Delta^1\rightarrow Y$ to decide where to map
$(x,h,t)\in\dom(p_!q^*(y))_k$, however this involves solving a coherence problem
and I would have to do so coherently to define a morphism of simplicial sets as
desired. Perhaps these restrictions actually allow a solution, but I do not
believe so.

It may also be possible that the injective morphism we mentioned earlier is a
weak equivalence with respect to our model structure, which may be enough.

We provide a counterexample to the previous claim in the context of right
fibrations. Consider
$\phi\colon\partial\Delta^1\rightarrow\Delta^1$, $i\mapsto 0$, which is a right
fibration. We have that $\phi^*(1)=0$, the empty simplicial set, thus
$\phi_*(f)^{-1}(1)\cong\Delta^0$. On the other hand, $(p_!q^*)(1)=U\amalg V$,
thus $q_*p^*(f)^{-1}(1)$ can be a disjoint union of non-zero simplicial sets,
which would then not be an equivalent $\infty$-groupoid. It follows that our map
is not, in general, a weak equivalence in the model structure of right
fibrations on slices of $\sSet$. \wfd{(MAYBE WRONG: YOU CAN'T CHECK THIS ON
FIBERS BECAUSE THESE ARE NOT FIBRANT OBJECTS IN $\sSet/Y$! NEED TO USE THE
DEFINITION CONCERNING HOMOTOPY CLASSES OF MAPS INTO FIBRANT OBJECTS IN THE
SLICE)}

If instead from a right fibration $\phi$ we first take the opposites of $\phi$
and $f$, then do the pushforward and finally we take again the opposites we get
$\phi_*(f)$, which is encoded in the following commutative diagram where the
vertical maps are isomorphisms.
\[\begin{tikzcd}
	{f\colon Z\rightarrow X} & {\sSet/X} & {\sSet/Y} & {f\colon Z\rightarrow Y} \\
	{f^{\op}\colon Z^{\op}\rightarrow X^{\op}} & {\sSet/X^{\op}} & {\sSet/Y^{\op}} & {f^{\op}\colon Z^{\op}\rightarrow Y^{\op}}
	\arrow["\op", from=1-3, to=2-3]
	\arrow["\op"', from=1-2, to=2-2]
	\arrow["{\phi^{\op}_*}"', from=2-2, to=2-3]
	\arrow["{\phi_*}", from=1-2, to=1-3]
	\arrow[maps to, from=1-1, to=2-1]
	\arrow[maps to, from=1-4, to=2-4]
\end{tikzcd}\]

The same argument extends to show that any map $\phi_*(f)\rightarrow q_*p^*(f)$
or in the other direction is not a weak equivalence in general. A concrete
example can be given by taking $f=\phi$.


\printbibliography

\end{document}

